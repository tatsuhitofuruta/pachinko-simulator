# 牙狼12（黄金騎士極限）LTシステム設計書

## 概要

本ドキュメントは、e牙狼12黄金騎士極限のLT（ラッキートリガー）システムの実装仕様をまとめたものです。

## 公式スペック（参照元）

| 項目 | 数値 | 備考 |
|------|------|------|
| 大当り確率 | 1/349.99（特図1） | 図柄揃い: 1/437.49 |
| LTチャレンジ突入率 | 50% | 初当たりの半分 |
| LTチャレンジ成功率 | 50% | |
| LT継続率 | 約76% | 25% + 51% |
| LT中出玉（大） | 7,500個 | 25%で獲得 |
| LT中出玉（小） | 1,500個 | 51%継続 / 24%転落 |

**参照元:**
- [1GEKI - 牙狼12 LT詳細](https://1geki.jp/pachinko/e_garo12/53/)
- [P-GABU - e牙狼12黄金騎士極限](https://p-gabu.jp/guideworks/machinecontents/detail/6881)
- [Altema - 牙狼12 スペック解説](https://altema.jp/pachimo/egaro12)

## 出玉変換（表記 → 実増え）

シミュレーターでは「実増え」で計算しています。

```
実増え = 表記出玉 × (14/15)
       = 表記出玉 - (表記出玉 / 15)  # 入賞分を引く
```

| 表記 | 実増え | 計算 |
|------|--------|------|
| 1,500個 | 1,400発 | 15賞玉 × 100カウント - 100入賞 |
| 7,500個 | 7,000発 | 15賞玉 × 500カウント - 500入賞 |

## ゲームフロー

```
┌─────────────────────────────────────────────────────────────┐
│                      通常時                                  │
│                    1/437.49                                  │
└─────────────────────┬───────────────────────────────────────┘
                      │ 当選
                      ▼
┌─────────────────────────────────────────────────────────────┐
│               初当たり: 1,400発（10R）                       │
└─────────────────────┬───────────────────────────────────────┘
                      │
          ┌───────────┴───────────┐
          │50%                    │50%
          ▼                       ▼
┌─────────────────┐     ┌─────────────────────────────────────┐
│   単発終了      │     │        LTチャレンジ                  │
│   (時短なし)    │     │        極限7500バトル                │
└─────────────────┘     └─────────────────┬───────────────────┘
                                          │
                              ┌───────────┴───────────┐
                              │50%                    │50%
                              ▼                       ▼
                    ┌─────────────────┐     ┌─────────────────────┐
                    │  チャレンジ敗北  │     │   チャレンジ成功     │
                    │   +1,400発      │     │   +7,000発（固定）   │
                    │     終了        │     │     LT突入          │
                    └─────────────────┘     └──────────┬──────────┘
                                                       │
                                                       ▼
                                           ┌───────────────────────┐
                                           │   魔戒CHANCE LT       │
                                           │   （76%ループ）       │
                                           └───────────┬───────────┘
                                                       │
                                  ┌────────────────────┼────────────────────┐
                                  │25%                 │51%                 │24%
                                  ▼                    ▼                    ▼
                        ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
                        │ GOD OF GARO     │  │   通常継続      │  │    LT転落       │
                        │   +7,000発      │  │   +1,400発      │  │   +1,400発      │
                        │   LT継続確定    │  │   LT継続        │  │     終了        │
                        └────────┬────────┘  └────────┬────────┘  └─────────────────┘
                                 │                    │
                                 └────────────────────┘
                                           │
                                           ▼
                                    （LTループへ戻る）
```

## 実装仕様

### MachineSpec パラメータ

```python
GARO12 = MachineSpec(
    name="牙狼12（黄金騎士極限）",
    hit_prob=1 / 437.49,           # 図柄揃い確率
    st_hit_prob=1.0,               # LT中は毎回当選
    border_touka=17.2,             # 等価ボーダー

    # ヘソ（初当たり）振り分け
    heso_payouts=[
        (0.50, 1400, True),        # 50%: 1,400発 → LTチャレンジ権利
        (0.50, 1400, False),       # 50%: 1,400発 → 単発終了
    ],

    # 電チュー（LT中）振り分け
    denchu_payouts=[
        (0.329, 7000),             # 継続時 約33%: GOD OF GARO 7500
        (0.671, 1400),             # 継続時 約67%: 通常継続
    ],

    st_spins=1,                    # LTは1回転判定
    st_continue_rate=0.76,         # LT継続率 76%

    # LTチャレンジ固有パラメータ
    lt_challenge_rate=0.50,        # LTチャレンジ成功率 50%
    lt_first_payout=7000,          # LT突入時の固定出玉 7,000発
    lt_end_payout=1400,            # LT転落/敗北時の出玉 1,400発
)
```

### 出玉振り分けの数学的根拠

LT継続率76%の内訳:
- 25%: GOD OF GARO 7500（7,000発 + 継続確定）
- 51%: 通常継続（1,400発 + 継続）
- 24%: LT転落（1,400発 + 終了）

シミュレーターでは簡略化して実装:
1. 継続判定（76%）を先に行う
2. 継続時に出玉振り分け（25/76 ≈ 33%で7,000発、51/76 ≈ 67%で1,400発）
3. 転落時は一律1,400発

```
継続時の7,000発確率 = 25% / 76% ≈ 32.9%
継続時の1,400発確率 = 51% / 76% ≈ 67.1%
```

これにより、期待値・分散は実機とほぼ同等になります。

### 期待出玉計算

**LT突入時の期待出玉:**

```
E[LT] = 初回7,000発 + Σ(継続回数 × 期待継続出玉) + 転落時1,400発

継続期待回数 = 1 / (1 - 0.76) - 1 = 3.17回
継続時期待出玉 = 0.329 × 7,000 + 0.671 × 1,400 = 3,243発

E[LT] = 7,000 + 3.17 × 3,243 + 1,400
      ≈ 18,680発
```

**初当たりからの期待出玉:**

```
E[総出玉] = 初当たり1,400発 + LTチャレンジ期待値
          = 1,400 + 0.50 × (敗北時1,400) + 0.50 × (成功時E[LT])
          = 1,400 + 0.50 × 1,400 + 0.50 × 18,680
          = 1,400 + 700 + 9,340
          ≈ 11,440発
```

## 検証結果

### シミュレーション出力例

```
▶ 当たり1: 260回転目 (累計260回転)
  初当たり: 1,400発 → ST非突入（単発）
  → 合計出玉: 1,400発

▶ 当たり2: 189回転目 (累計449回転)
  初当たり: 1,400発 → LTチャレンジ成功 → LT突入 → 7連
    LT突入: 7,000発
    3連目: 1,400発
    4連目: 7,000発
    5連目: 1,400発
    6連目: 1,400発
    7連目: 1,400発
    LT転落: 1,400発
  → 合計出玉: 22,400発
```

### 実装の妥当性

| 項目 | 公式スペック | 実装値 | 差異 |
|------|-------------|--------|------|
| 大当り確率 | 1/437.49 | 1/437.49 | なし |
| LTチャレンジ突入率 | 50% | 50% | なし |
| LTチャレンジ成功率 | 50% | 50% | なし |
| LT継続率 | 76% | 76% | なし |
| GOD OF GARO確率 | 25%（全体） | 25%（76%×33%） | 計算上同等 |
| 出玉（大） | 7,500個 | 7,000発 | 実増え換算で同等 |
| 出玉（小） | 1,500個 | 1,400発 | 実増え換算で同等 |

## 更新履歴

| 日付 | バージョン | 内容 |
|------|-----------|------|
| 2026-01-06 | v1.4.0 | 牙狼12機種追加（基本LTシステム） |
| 2026-01-06 | v1.4.1 | LT中出玉振り分けを修正 |
| 2026-01-06 | v1.4.2 | LTチャレンジ成功時の固定7,000発を実装 |
